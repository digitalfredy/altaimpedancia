#summary Como envio un dato por puerto serial desde Linux al AVR
#labels rolin

== Buscando documentación ==
 * En la pág 136 de la [http://www.atmel.com/dyn/resources/prod_documents/doc2502.pdf hoja de datos del atmega8535] hablan de Peripherical Interface (SPI) Esto creo que es suficiente pues solo voy a enviar datos desd el router, también existe Universal Syncronous and Asincronous Serial Reciber and Transmiter (USART) y de Two-wire Serial Interface (TWI) que serán útiles en el futuro pero de momento SPI.
 * [http://winavr.scienceprog.com/avr-gcc-tutorial/serial-peripheral-interface-spi-of-avr-microcontrollers.html Este tutorial es el primero que encuentro]
 * En avr-libc encontré más de TWI que de SPI
  * [http://www.nongnu.org/avr-libc/user-manual/group__avr__interrupts.html buscar en tabla SPI, USART y TWI
  * [http://www.nongnu.org/avr-libc/user-manual/group__util__twi.html info detallada de twi.h] según entendí es lo mismo que I2C
  * [http://www.nongnu.org/avr-libc/user-manual/group__twi__demo.html ejemplo con TWI]

Me pregunto si va a tocar usar USART o TWI, bueno sigo buscando ..
 * En [http://www.avrfreaks.net/index.php?name=PNphpBB2&file=viewtopic&t=84829este foro de avrfreaks] hablan de spi.h, yo he buscado por todo mi disco duro y encontré un spi.h en las cabeceras del kernel de linux por lo cual este no es el camino :(
 * En [http://www.ermicro.com/blog/?p=1050 este blog] usan #include <avr/io.h> y #define SPI_ ... tocaría ver si con avr-libc en linux funciona, tiene pinta :)

Recuerdo que tengo dos enlaces sobre avr y linux voy a revisar si hablan del puerto serial, tal vez mi busqueda no la deba centrar en SPI sino en linux avr serial

 * [http://pramode.net/articles/lfy/atmega8/pramode.html ESTE documento] hay que revisarlo con detalle, creo que es el que me va a dar luces 
 * [http://www.mightyohm.com/blog/2009/02/building-a-wifi-radio-part-8-adding-a-tuning-control/ aqui] usan el serial desde shell para enviar datos al avr usando echo :) creo que este proyecto es otra buena REFERENCIA
  * Puede servir pero para el control de los motores :P mirar la sección de programar puerto serial

Yo sigo empeñado que es por el lado de SPI (soy terco pero pienso por ejemplo que si uno programa el mircro con SPI entonces es el camino)

 * [http://en.wikipedia.org/wiki/Serial_Peripheral_Interface_Bus Aprendiendo un poco sobre SPI en la wikipedia] sigo pensando que este es el camino

=== El puerto serial AVR, PC LINUX y WRT54G con OpenWRT ===
Mi idea inicial para no perder tiempo era primero enviar algo del pc al micro y luego ver como funcionaba desde el router donde debería ser parecido pero un poco más dificil, he leído un poco en el libro !LinksysUltimateHacking y he llegado a la conclusión que el AVR y el router usan TTL y no requieren un chip MAX232 (Conversor TTL a Serial) que si se requiere para comunicarse con el PC, y bueno con el ánimo de ganar tiempo queda descartada la idea inicial y trabajaré directamente en el router. 

He leído [http://www.herbert-dingfelder.de/WRT54GL_add_on/WRT54GL_add_on.html en esta página] que alguien hizo la conexión directa con el avr, yo traté de usar el avr a 3.3V y no funcionó, no se si estando alimentado funcione pero me da miedo enviar al router 5V y quemarlo, lo ideal sería usar un atmega8535L que puede funcionar a 3.3V pero de momento se me acaba de ocurrir que como el AVR solo va a recibir pues dejar desconectado el cable que transmite :P y ver si recibiendo niveles TTL a 3.3V los puede entender :/